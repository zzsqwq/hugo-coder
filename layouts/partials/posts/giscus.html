{{- if isset .Site.Params "giscus" -}}
  {{- if and (not (eq .Site.Params.giscus.dataRepo "" )) (eq (.Params.disableComments | default false) false) -}}
  <div class="comments">
  <script>

  let getTheme = window.localStorage && window.localStorage.getItem("colorscheme");

  getTheme = getTheme == null ? '{{$.Site.Params.giscus.dataTheme}}' : getTheme;
  
  let theme = getTheme === 'dark' ? 'dark' : 'light';
  let s = document.createElement('script');
  s.src = 'https://giscus.app/client.js';
  s.setAttribute('data-repo', '{{ .Site.Params.giscus.dataRepo }}');
  s.setAttribute('data-repo-id', '{{ .Site.Params.giscus.dataRepoId }}');
  s.setAttribute('data-category', '{{ .Site.Params.giscus.dataCategory }}');
  s.setAttribute('data-category-id', '{{ .Site.Params.giscus.dataCategoryId }}');
  s.setAttribute('data-mapping', '{{ .Site.Params.giscus.dataMapping }}');
  s.setAttribute('data-strict', '{{ .Site.Params.giscus.dataStrict }}');
  s.setAttribute('data-reactions-enabled', '{{ .Site.Params.giscus.dataReactionsEnabled }}');
  s.setAttribute('data-emit-metadata', '{{ .Site.Params.giscus.dataEmitMetadata }}');
  s.setAttribute('data-input-position', '{{ .Site.Params.giscus.dataInputPosition }}');
  s.setAttribute('data-theme', theme);
  s.setAttribute('data-lang', '{{ .Site.Params.giscus.dataLang }}');
  s.setAttribute('crossorigin', '{{ .Site.Params.giscus.crossorigin }}');
  s.setAttribute('async', '');
  document.querySelector('div.comments').innerHTML = '';
  document.querySelector('div.comments').appendChild(s);

  </script>
  </div>
  {{- end -}}
{{- end -}}

